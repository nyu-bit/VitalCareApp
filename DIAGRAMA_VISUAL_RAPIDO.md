# ๐จ DIAGRAMA VISUAL RรPIDO - VitalCare Backend Integration

## 1. FLUJO SIMPLE: GET /vitales

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                       ๐ฑ ANDROID APP                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                  โ
โ  User abre VitalesScreen                                        โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ  โ VitalesScreen (Compose) โ โ Muestra datos                   โ
โ  โ  LazyColumn {           โ                                   โ
โ  โ    items(vitales)       โ                                   โ
โ  โ  }                      โ                                   โ
โ  โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ                                   โ
โ           โ                                                     โ
โ           โ Observa StateFlow                                  โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ  โ VitalesViewModel        โ โ Maneja estado                   โ
โ  โ loadAllVitales()        โ                                   โ
โ  โ StateFlow<VitalesUiState>                                  โ
โ  โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ                                   โ
โ           โ                                                     โ
โ           โ Llama repository.getAllVitales()                   โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ  โ VitalesRepository       โ โ Abstrae datos                   โ
โ  โ getAllVitales() {       โ                                   โ
โ  โ   try {                 โ                                   โ
โ  โ     vitalesApi.get...   โ                                   โ
โ  โ   } catch { Result.fail }                                  โ
โ  โ }                       โ                                   โ
โ  โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ                                   โ
โ           โ                                                     โ
โ           โ Usa vitalesApi.getAllVitales()                     โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ  โ VitalesApi (Retrofit)   โ โ Hace HTTP request              โ
โ  โ @GET("vitales")         โ                                   โ
โ  โ suspend fun get...()    โ                                   โ
โ  โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ                                   โ
โ           โ                                                     โ
โ           โ HTTP GET                                           โ
โ           โ http://10.0.2.2:8081/vitales                       โ
โ           โ                                                     โ
โโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ
      โโโโโโโฉโโโโโโ
      โ INTERNET  โ
      โโโโโโโคโโโโโโ
            โ
            โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                     ๐ฅ๏ธ BACKEND REMOTO                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                  โ
โ  HTTP GET /vitales recibido en port 8081                        โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ  โ VitalesController       โ โ REST endpoint                   โ
โ  โ GET /vitales            โ                                   โ
โ  โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ                                   โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ  โ VitalesService          โ โ Lรณgica                          โ
โ  โ getAllVitales()         โ                                   โ
โ  โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ                                   โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ  โ VitalesRepository (JPA) โ โ ORM                             โ
โ  โ findAll()               โ                                   โ
โ  โโโโโโโโโโฌโโโโโโโโโโโโโโโโโ                                   โ
โ           โ                                                     โ
โ           โ SQL Query                                          โ
โ           โ SELECT * FROM signos_vitales                       โ
โ           โ                                                     โ
โโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ
            โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                     ๐พ MySQL DATABASE                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                  โ
โ  Table: signos_vitales                                          โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                   โ
โ  โ id โ pacienteId โ fc โ presion โ temp... โ                  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค                   โ
โ  โ 1  โ P123       โ 72 โ 120/80  โ 36.5    โ                  โ
โ  โ 2  โ P124       โ 75 โ 125/82  โ 36.8    โ                  โ
โ  โ 3  โ P123       โ 73 โ 122/81  โ 36.6    โ                  โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ                   โ
โ                                                                  โ
โ  Retorna: 3 filas                                               โ
โ                                                                  โ
โโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ
            โ Resultados
            โ
            โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                     ๐ฅ๏ธ BACKEND REMOTO                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                  โ
โ  VitalesRepository retorna List<SignosVitales>                 โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  VitalesService procesa datos                                  โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  VitalesController serializa a JSON                            โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  HTTP 200 OK                                                    โ
โ  Content-Type: application/json                                โ
โ  Body: [                                                        โ
โ    {                                                            โ
โ      "id": "1",                                                 โ
โ      "pacienteId": "P123",                                      โ
โ      "frecuenciaCardiaca": 72,                                  โ
โ      "presionArterial": "120/80",                               โ
โ      "temperatura": 36.5,                                       โ
โ      ...                                                        โ
โ    },                                                           โ
โ    ...                                                          โ
โ  ]                                                              โ
โ                                                                  โ
โโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ
      โโโโโโโฉโโโโโโ
      โ INTERNET  โ
      โโโโโโโคโโโโโโ
            โ
            โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                       ๐ฑ ANDROID APP                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                  โ
โ  HTTP 200 Response recibida                                     โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  Retrofit JSON deserialization                                 โ
โ  GSON convierte JSON โ List<SignosVitalesDto>                  โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  VitalesRepository onSuccess()                                 โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  VitalesViewModel.onSuccess { vitales โ                        โ
โ    _uiState.update {                                           โ
โ      copy(vitales = vitales, isLoading = false)                โ
โ    }                                                            โ
โ  }                                                              โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  StateFlow emite nuevo estado                                  โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  VitalesScreen detecta cambio                                  โ
โ  collectAsState() โ recompone Compose                          โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  LazyColumn renderiza items                                    โ
โ           โ                                                     โ
โ           โผ                                                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ  โ VitalCard #1            โ                                   โ
โ  โ โค๏ธ FC: 72 bpm          โ                                   โ
โ  โ ๐ก๏ธ Temp: 36.5ยฐC         โ                                   โ
โ  โ ๐ฅ Presiรณn: 120/80      โ                                   โ
โ  โ ๐จ Oโ: 98%              โ                                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโ                                   โ
โ                                                                  โ
โ  [Mรกs tarjetas...]                                              โ
โ                                                                  โ
โ  โ USUARIO VE DATOS REALES DEL BACKEND                        โ
โ                                                                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

TIEMPO TOTAL: ~500-1000 ms
```

---

## 2. FLUJO POST: Crear Vital

```
User โ Form โ submitButton
         โ
         โผ
VitalesViewModel.createVital(vital)
   isLoading = true
         โ
         โผ
Repository.createVital(vital)
   try {
     vitalesApi.createVital(vital)
   }
         โ
         โ HTTP POST body JSON
         โ http://10.0.2.2:8081/vitales
         โ
         โผ
Backend:
   Controller โ Service โ JPA
         โ
         โผ
MySQL:
   INSERT INTO signos_vitales
   VALUES (...)
         โ
   MySQL genera ID: vital_999
         โ
         โผ
Response JSON:
   {
     "id": "vital_999",  โ NUEVO ID
     "pacienteId": "P123",
     ...
   }
         โ
         โผ
Retrofit โ GSON โ SignosVitalesDto
         โ
         โผ
ViewModel.onSuccess():
   _uiState.update {
     vitales = vitales + createdVital
     isLoading = false
   }
         โ
         โผ
StateFlow โ Compose recompone
         โ
         โผ
LazyColumn renderiza NUEVO VITAL
         โ
         โผ
User ve dato creado โ
```

---

## 3. FLUJO DELETE: Eliminar Vital

```
VitalCard delete button
         โ
         โผ
ViewModel.deleteVital(id)
         โ
         โผ
Repository.deleteVital(id)
   HTTP DELETE /vitales/id1
         โ
         โผ
Backend:
   Controller โ Service โ JPA
         โ
         โผ
MySQL:
   DELETE FROM signos_vitales
   WHERE id = 'id1'
         โ
         โผ
Response:
   HTTP 200 OK
         โ
         โผ
ViewModel.onSuccess():
   _uiState.update {
     vitales = vitales.filter { it.id != id }
   }
         โ
         โผ
Compose recompone
         โ
         โผ
LazyColumn actualiza (sin el item)
         โ
         โผ
User ve lista sin el vital eliminado โ
```

---

## 4. ESTADOS DE LA UI

```
INICIO
  โ
  โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ isLoading = false                   โ
โ vitales = []                        โ
โ error = null                        โ
โ                                     โ
โ Estado: ESTADO_INICIAL              โ
โโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ
           โ LaunchedEffect โ loadAllVitales()
           โ
           โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ isLoading = true                    โ
โ vitales = []                        โ
โ error = null                        โ
โ                                     โ
โ Estado: CARGANDO                    โ
โ                                     โ
โ UI:                                 โ
โ  โณ Cargando signos vitales...       โ
โ  [CircularProgressIndicator]        โ
โโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ
           โโ API Exitosa
           โ  โ
           โ  โผ
           โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ โ isLoading = false            โ
           โ โ vitales = [V1, V2, V3]       โ
           โ โ error = null                 โ
           โ โ                              โ
           โ โ Estado: รXITO                โ
           โ โ                              โ
           โ โ UI:                          โ
           โ โ [VitalCard1]                 โ
           โ โ [VitalCard2]                 โ
           โ โ [VitalCard3]                 โ
           โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ
           โโ API Falla
              โ
              โผ
             โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ isLoading = false            โ
             โ vitales = []                 โ
             โ error = "Error de conexiรณn"  โ
             โ                              โ
             โ Estado: ERROR                โ
             โ                              โ
             โ UI:                          โ
             โ โ๏ธ Error de conexiรณn         โ
             โ [Descartar] [Reintentar]    โ
             โโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโ
                    โ
                    โ Click Reintentar
                    โ
                    โโ Vuelve a CARGANDO
```

---

## 5. ARQUITECTURA EN CAPAS

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ           PRESENTATION LAYER (UI)               โ
โ                                                 โ
โ  VitalesScreen โ AlertasScreen โ ...           โ
โ  (Composables)                                  โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ collectAsState()
                   โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          VIEWMODEL LAYER (State)                โ
โ                                                 โ
โ  VitalesViewModel โ StateFlow<UiState>         โ
โ  AlertsViewModel โ StateFlow<UiState>          โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ suspend fun
                   โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ       REPOSITORY LAYER (Data Abstraction)       โ
โ                                                 โ
โ  VitalesRepository โ getAllVitales()           โ
โ  AlertasRepository โ getAll()                  โ
โ  (Try/Catch โ Result<T>)                       โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ Retrofit call
                   โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ        API LAYER (Retrofit/HTTP)                โ
โ                                                 โ
โ  VitalesApi โ @GET("vitales")                  โ
โ  AlertasApi โ @GET("alertas")                  โ
โ  (GSON deserialization)                        โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ HTTP Request/Response
                   โผ
        โโโโโโโโโโโโโโโโโโโโโโโโ
        โ INTERNET / NETWORK   โ
        โโโโโโโโโโโโโโโโโโโโโโโโ
                   โ
                   โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ     BACKEND LAYER (Spring Boot/Java)            โ
โ                                                 โ
โ  Controllers โ Services โ Repositories          โ
โ  (Business Logic)                               โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ SQL Query
                   โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      DATABASE LAYER (MySQL)                     โ
โ                                                 โ
โ  signos_vitales | ubicaciones | alertas         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## 6. COMPONENTES PRINCIPALES

```
VitalCareApp
โ
โโ MainActivity
โ  โโ VitalCareTheme
โ     โโ VitalCareNavigation
โ        โ
โ        โโ NavHost (5 rutas)
โ        โ  โโ Dashboard
โ        โ  โโ Vitales โ VitalesScreen
โ        โ  โโ Ubicaciรณn
โ        โ  โโ Alertas โ AlertasScreen
โ        โ  โโ Clima
โ        โ
โ        โโ BottomNavigationBar (5 items)
โ
โโ ViewModels
โ  โโ VitalesViewModel (StateFlow)
โ  โโ AlertsViewModel (StateFlow)
โ  โโ ...
โ
โโ Repositories
โ  โโ VitalesRepository
โ  โโ AlertasRepository
โ  โโ ...
โ
โโ APIs (Retrofit)
โ  โโ VitalesApi
โ  โโ AlertasApi
โ  โโ ...
โ
โโ RetrofitInstance (Singleton)
   โโ vitalesRetrofit: 8081
   โโ ubicacionRetrofit: 8082
   โโ alertasRetrofit: 8083
   โโ weatherRetrofit: OpenWeatherMap
```

---

## โ RESUMEN

```
ยฟCONEXIรN CON BACKEND LISTA?

SI โ

Flujo: UI โ ViewModel โ Repository โ Retrofit โ Backend โ MySQL
  โ Todo implementado
  โ Todo documentado
  โ Todo listo para usar

Solo falta: Backend ejecutando + Base de datos con datos

Cuando tengas eso: App automรกticamente conectarรก y mostrarรก datos reales
```

---

**USAR ESTOS DIAGRAMAS PARA ESTUDIAR Y VERIFICAR EL FLUJO COMPLETO** ๐


